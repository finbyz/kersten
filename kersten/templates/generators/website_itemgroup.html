{% from "webshop/templates/includes/macros.html" import field_filter_section, attribute_filter_section, discount_range_filters %}
{% extends "templates/web.html" %}

{% block header %}
<div class="mb-6"><h1>{{ _(website_title or website_itemgroup_name) }}</h1></div>
{% if doc.show_related_website_item %}
<style>
    .btn-prev, .btn-next {
        display: none !important;
    }
</style>
{% endif %}
<style>
    .text-color{
        color: black;
    }
     @media (max-width: 768px) {
    .centered {
        position: absolute;
        top: 40%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 100%;
        color: white; 
    }
}
@media only screen and (max-width: 768px) {
    .section-cta-and-image {
        position: relative;
        border-radius: 1rem;
        max-width: 100%;
        height: auto;
        overflow: hidden;
        min-height:170px;
    }
}
</style>
{% endblock header %}

{% block script %}
<script type="text/javascript" src="/all-products/index.js"></script>
{% endblock %}

{% block breadcrumbs %}
<div class="item-breadcrumbs small text-muted">
    {% include "templates/includes/breadcrumbs.html" %}
</div>
{% endblock %}

{% block page_content %}
{% from "erpnext/templates/includes/macros.html" import product_image %}
{% if banner %}
<div class="section-cta-container">
    <div class="section-cta-and-image">
        <div class="image-wrapper">
            <img src="{{ banner }}" alt="{{ title }}" style="opacity: 0.8; width: 100%; height:auto;" />
        </div>
        <div class="centered text-center">
            <p class="title mt-0 text-color"
                style="text-shadow: white; font-size: 3rem;  color: 3px 3px 6px rgba(0, 0, 0, 0.4); width: 100%;">
                {{website_itemgroup_name}}</p>
        </div>
    </div>
</div>
{% endif %}
<div class="product-description" itemprop="description">
    {% if frappe.utils.strip_html(doc.description or '') %}
    {{ doc.description }}
    {% else %}
    {{ "" }}
    {% endif %}
</div>
<div class="item-content">
    <div class="product-page-content">
        {% if doc.content_type_page == 'Page Builder' %}
        {{ page_builder_html2 }}
        {% else %}
        {{ doc.website_content_page or '' }}
        {% endif %}
    </div>
</div>

<div class="item-group-content" data-item-group="{{ name }}">
    <div class="item-group-slideshow">
        {% if slideshow %} <!-- slideshow -->
            {{ web_block(
            "Hero Slider",
            values=slideshow,
            add_container=0,
            add_top_padding=0,
            add_bottom_padding=0,
            ) }}
        {% endif %}
    </div>
</div>

<div class="related-items-section mt-6">
    <!-- {% if related_items %}
    <h3 class="section-title">{{ _("Related Items") }}</h3>
    {% endif %} -->
    <div class="card-grid row row-cols-1 row-cols-md-4 g-4">
        {% for item in related_items %}

        <div class="col mt-2">
            <div class="card h-100">
                {% if item.image %}
                <img class="card-img-top" src="{{ item.image }}" alt="{{ item.name }}">
                {% else %}
                <div class="placeholder-div">
                    <span class="placeholder">
                        {{ frappe.utils.get_abbr(item.name or '') }}
                        
                    </span>
                </div>
                {% endif %}

                <div class="card-body">
                    <h3 class="card-title mt-0">
                    {{ item.name or '' }}
                </h3>
                </div>
                <a href="/{{ item.route or '#' }}" class="stretched-link"></a>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
<br>
<br>
{% if doc.show_related_website_item %}
<div class="row">
    <h3 class="section-title">{{ _("Related Website Items") }}</h3>
    <div id="product-listing" class="col-12 order-2 col-md-12 order-md-2 item-card-group-section">
        <!-- Products Rendered in all-products/index.js-->
    </div>

    
</div>
{% endif %}
<div class="item-content">
    <div class="product-page-content">
        {% if doc.content_type == 'Page Builder' %}
        {{ page_builder_html }}
        {% else %}
        {{ doc.website_content or '' }}
        {% endif %}
    </div>
</div>
{% if doc.faq_group %}
{% for i in doc.faq_group %}
{% set group = frappe.get_doc("FAQ Groups",i.faq_group_item)%}
{% for row in group.faq_questions %}
{% set faq = frappe.get_doc("FAQ",row.question)%}
<div class="collapsible-item">
    <a aria-controls="id-732e168a92ce-1" aria-expanded="false" class="collapsible-title" data-toggle="collapse" href="#id-732e168a92ce-{{row.idx}}" role="button">
        <div class="collapsible-item-title">{{faq.question}}</div>
        <svg class="collapsible-icon" height="24" viewBox="0 0 16 16" width="24" xmlns="http://www.w3.org/2000/svg">
            <path class="vertical" d="M8 4V12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="1.5"></path>
            <path class="horizontal" d="M4 8H12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="1.5"></path>
        </svg>
    </a>
    <div class="collapse collapsible-content from-markdown" id="id-732e168a92ce-{{row.idx}}">
        <div>
            <p>{{faq.answer}}</p>
            {% if faq.related_title  and faq.related_url %}
            <i><a href="{% if faq.related_url %}{{faq.related_url}}{% else %} # {% endif %}">{{faq.related_title}}</a></i>
            {%endif%}
        </div>
    </div>
</div>
{% endfor %}
{% endfor %}
{% endif %}
<script>
    frappe.ready(() => {
        $('.btn-prev, .btn-next').click((e) => {
            const $btn = $(e.target);
            $btn.prop('disabled', true);
            const start = $btn.data('start');
            let query_params = frappe.utils.get_query_params();
            query_params.start = start;
            let path = window.location.pathname + '?' + frappe.utils.get_url_from_dict(query_params);
            window.location.href = path;
        });
    });
</script>
{% endblock %}