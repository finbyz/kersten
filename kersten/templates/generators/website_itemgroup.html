{% from "webshop/templates/includes/macros.html" import field_filter_section, attribute_filter_section, discount_range_filters %}
{% extends "templates/web.html" %}

{% block header %}
<div class="mb-6">{{ _(website_title or website_itemgroup_name) }}</div>
{% endblock header %}

{% block script %}
<script type="text/javascript" src="/all-products/index.js"></script>
{% endblock %}

{% block breadcrumbs %}
<div class="item-breadcrumbs small text-muted">
    {% include "templates/includes/breadcrumbs.html" %}
</div>
{% endblock %}

{% block page_content %}
{% from "erpnext/templates/includes/macros.html" import product_image %}
<div class="section-cta-container">
    <div class="section-cta-and-image">
        <div class="image-wrapper">
            <img src="{{ image }}" alt="{{ title }}" style="opacity: 0.8; width: 100%; height:auto;" />
        </div>
        <div class="centered text-center">
            <h2 class="title mt-0"
                style="text-shadow: white; font-size: 3rem;  color: 3px 3px 6px rgba(0, 0, 0, 0.4); width: 100%;">
                {{website_itemgroup_name}}</h2>
        </div>
    </div>
</div>
<div class="product-description" itemprop="description">
    {% if frappe.utils.strip_html(doc.description or '') %}
    {{ doc.description }}
    {% else %}
    {{ "" }}
    {% endif %}
</div>
<div>
</div>

<div class="item-group-content" itemscope itemtype="http://schema.org/Product" data-item-group="{{ name }}">
    <div class="item-group-slideshow">
        {% if slideshow %} <!-- slideshow -->
            {{ web_block(
            "Hero Slider",
            values=slideshow,
            add_container=0,
            add_top_padding=0,
            add_bottom_padding=0,
            ) }}
        {% endif %}
    </div>
</div>

<div class="related-items-section mt-6">
    <h3 class="section-title">{{ _("Related Items") }}</h3>
    <div class="card-grid row row-cols-1 row-cols-md-4 g-4">
        {% for item in related_items %}
        <div class="col mt-2">
            <div class="card h-100">
                {% if item.image %}
                <img class="card-img-top" src="{{ item.image }}" alt="{{ item.name }}">
                {% else %}
                <div class="placeholder-div">
                    <span class="placeholder">
                        {{ frappe.utils.get_abbr(item.name or '') }}
                    </span>
                </div>
                {% endif %}

                <div class="card-body text-center text-muted small">
                    {{ item.name or '' }}
                </div>
                <a href="{{ item.route or '#' }}" class="stretched-link"></a>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
<br>
<br>
<div class="row">
    <h3 class="section-title">{{ _("Related Website Items") }}</h3>
    <div id="product-listing" class="col-12 order-2 col-md-12 order-md-2 item-card-group-section">
        <!-- Products Rendered in all-products/index.js-->
    </div>

    
</div>
<div class="item-content">
    <div class="product-page-content" itemscope itemtype="http://schema.org/Product">
        {% if doc.content_type == 'Page Builder' %}
        {{ page_builder_html }}
        {% else %}
        {{ doc.website_content or '' }}
        {% endif %}
    </div>
</div>
<script>
    frappe.ready(() => {
        $('.btn-prev, .btn-next').click((e) => {
            const $btn = $(e.target);
            $btn.prop('disabled', true);
            const start = $btn.data('start');
            let query_params = frappe.utils.get_query_params();
            query_params.start = start;
            let path = window.location.pathname + '?' + frappe.utils.get_url_from_dict(query_params);
            window.location.href = path;
        });
    });
</script>
{% endblock %}
